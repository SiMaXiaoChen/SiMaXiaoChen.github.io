<!doctype html>




<html class="theme-next mist" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="天意,读书,感悟,笔记" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="这是一个想到什么就写一些什么的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="难得糊涂">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="难得糊涂">
<meta property="og:description" content="这是一个想到什么就写一些什么的博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="难得糊涂">
<meta name="twitter:description" content="这是一个想到什么就写一些什么的博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"hide","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: false,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title> 难得糊涂 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">难得糊涂</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">洗去铅华，重拾初心</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/14/algorithm/字符串包含（Java）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="天意">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://oaxelf1sk.bkt.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="难得糊涂">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/14/algorithm/字符串包含（Java）/" itemprop="url">
                  字符串包含（Java）
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-14T16:12:33+08:00">
                2017-03-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index">
                    <span itemprop="name">Algorithm</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>给定两个分别由字母组成的字符串A和字符串B，字符串B的长度比字符串A短。请问，如何最快地判断字符串B中所有字母是否都在字符串A里？</p>
<p>为了简单起见，我们规定输入的字符串只包含大写英文字母，请实现函数bool StringContains(string &amp;A, string &amp;B)</p>
<p>比如，如果是下面两个字符串：</p>
<p>String 1：ABCD</p>
<p>String 2：BAD</p>
<p>答案是true，即String2里的字母在String1里也都有，或者说String2是String1的真子集。</p>
<p>如果是下面两个字符串：</p>
<p>String 1：ABCD</p>
<p>String 2：BCE</p>
<p>答案是false，因为字符串String2里的E字母不在字符串String1里。</p>
<p>同时，如果string1：ABCD，string 2：AA，同样返回true。</p>
<h2 id="解释"><a href="#解释" class="headerlink" title="解释"></a>解释</h2><p>思路一：遍历字符串B，判断每一个字符是否出现在字符串A中，时间复杂度O(n*m)，空间复杂度O(1)</p>
<p>增加一个数据，用来记录光标的移动</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    System.out.println(con(<span class="keyword">new</span> <span class="keyword">char</span>[]&#123;<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>&#125;, <span class="keyword">new</span> <span class="keyword">char</span>[]&#123;<span class="string">'B'</span>&#125;));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">con</span><span class="params">(<span class="keyword">char</span>[] charA, <span class="keyword">char</span>[] charB)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; charB.length; i++) &#123;</div><div class="line">        <span class="keyword">int</span> index;</div><div class="line">        <span class="keyword">for</span> (index = <span class="number">0</span>; (index &lt; charA.length) &amp;&amp; (charA[index] != charB[i]); index++) &#123;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (index&gt;=charA.length)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>思路二：先对两个字符串排序，然后同时遍历字符串A和B，判断B中的每一个字符是否都在字符串A中。时间复杂度O(nlogn)，空间复杂度O(1)</p>
<p>这次增加两个光标，用于指定两个char类型的数组：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span>[] charA = &#123;<span class="string">'D'</span>, <span class="string">'A'</span>, <span class="string">'C'</span>&#125;;</div><div class="line">    <span class="keyword">char</span>[] charB = &#123;<span class="string">'D'</span>, <span class="string">'C'</span>&#125;;</div><div class="line">    sort(charA);</div><div class="line">    sort(charB);</div><div class="line">    System.out.println(con(charA, charB));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">con</span><span class="params">(<span class="keyword">char</span>[] charA, <span class="keyword">char</span>[] charB)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> a = <span class="number">0</span>, b = <span class="number">0</span>; b &lt; charB.length; ) &#123;</div><div class="line">        <span class="keyword">while</span> ((a &lt; charA.length) &amp;&amp; (charA[a] &lt; charA[b])) &#123;</div><div class="line">            ++a;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> ((a&gt;charA.length)||(charA[a]&gt;charB[b]))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        ++b;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line"> <span class="comment">/**</span></div><div class="line"> * 选择排序算法</div><div class="line"> * 在未排序序列中找到最小元素，存放到排序序列的起始位置</div><div class="line"> * 再从剩余未排序元素中继续寻找最小元素，然后放到排序序列第二个位置。</div><div class="line"> * 以此类推，直到所有元素均排序完毕。</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">char</span>[] chars)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> temp;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; chars.length; i++) &#123;</div><div class="line">        <span class="keyword">int</span> min = i;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; chars.length; j++) &#123;</div><div class="line">            <span class="keyword">if</span> (chars[min] &gt; chars[j]) &#123;</div><div class="line">                min = j;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        temp = chars[i];</div><div class="line">        chars[i] = chars[min];</div><div class="line">        chars[min] = temp;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>思路三：将每一个字符映射到一个素数上，对字符串A中的每一个字符表示的素数，求累积；然后遍历字符串B，用每一个字符表示的素数去除字符串A的累积，判断余数是否为0。时间复杂度：O(n)，空间复杂度O(1)。可能存在的问题：乘积时可能会溢出。</p>
<p>假设有一个仅由字母组成字串，让每个字母与一个素数对应，从2开始，往后类推，A对应2，B对应3，C对应5，……。遍历第一个字串，把每个字母对应素数相乘。最终会得到一个整数。</p>
<p>利用上面字母和素数的对应关系，对应第二个字符串中的字母，然后轮询，用每个字母对应的素数除前面得到的整数。如果结果有余数，说明结果为false。如果整个过程中没有余数，则说明第二个字符串是第一个的子集了（判断是不是真子集，可以比较两个字符串对应的素数乘积，若相等则不是真子集）。</p>
<p>思路总结如下：</p>
<ol>
<li>按照从小到大的顺序，用26个素数分别与字符’A’到’Z’一一对应。</li>
<li>遍历长字符串，求得每个字符对应素数的乘积。</li>
<li>遍历短字符串，判断乘积能否被短字符串中的字符对应的素数整除。</li>
<li>输出结果。</li>
</ol>
<p>如前所述，算法的时间复杂度为O(m+n)的最好的情况为O(n)（遍历短的字符串的第一个数，与长字符串素数的乘积相除，即出现余数，便可退出程序，返回false），n为长字串的长度，空间复杂度为O(1)。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">     <span class="keyword">char</span>[] charA = &#123;<span class="string">'D'</span>, <span class="string">'A'</span>, <span class="string">'C'</span>&#125;;</div><div class="line">     <span class="keyword">char</span>[] charB = &#123;<span class="string">'D'</span>, <span class="string">'C'</span>&#125;;</div><div class="line">     System.out.println(con(charA, charB));</div><div class="line"> &#125;</div><div class="line"></div><div class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">con</span><span class="params">(<span class="keyword">char</span>[] charA, <span class="keyword">char</span>[] charB)</span> </span>&#123;</div><div class="line">     <span class="keyword">int</span>[] p = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>,</div><div class="line">             <span class="number">37</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>, <span class="number">59</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">97</span>, <span class="number">101</span>&#125;;</div><div class="line">     <span class="keyword">int</span> sum = <span class="number">1</span>;</div><div class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; charA.length; i++) &#123;</div><div class="line">         sum *= p[charA[i] - <span class="string">'A'</span>];</div><div class="line">     &#125;</div><div class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; charB.length; i++) &#123;</div><div class="line">         <span class="keyword">if</span> (sum % p[charB[i] - <span class="string">'A'</span>] != <span class="number">0</span>) &#123;</div><div class="line">             <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">         &#125;</div><div class="line">     &#125;</div><div class="line">     <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>思路四：如果可以使用Java中的数据结构，HashMap和Set可以很方便地解决问题；如果不能，我们可以构造一个“签名”，将每一个字符映射为整数(范围：0到26)，然后遍历A中的每一个字符，将32位整数的对应位置1(整数初始为0)，最后遍历B中的每一个字符，判断每一个字符代表的整数在整数中是否已置位。时间复杂度O(n)，空间复杂度O(1)，思路四为最优算法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 位与( &amp; )</span></div><div class="line"><span class="comment">// 位与：第一个操作数的的第n位于第二个操作数的第n位如果都是1，那么结果的第n为也为1，否则为0</span></div><div class="line">System.out.println(<span class="number">5</span> &amp; <span class="number">3</span>);<span class="comment">// 结果为1</span></div><div class="line">System.out.println(<span class="number">4</span> &amp; <span class="number">1</span>);<span class="comment">// 结果为0</span></div><div class="line">	</div><div class="line"><span class="comment">// 位或( | )</span></div><div class="line"><span class="comment">// 第一个操作数的的第n位于第二个操作数的第n位 只要有一个是1，那么结果的第n为也为1，否则为0</span></div><div class="line">System.out.println(<span class="number">5</span> | <span class="number">3</span>);<span class="comment">// 结果为7</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 左移( &lt;&lt; )</span></div><div class="line"><span class="comment">// 0000 0000 0000 0000 0000 0000 0000 0101 然后左移2位后，低位补0：//</span></div><div class="line"><span class="comment">// 0000 0000 0000 0000 0000 0000 0001 0100 换算成10进制为20</span></div><div class="line">System.out.println(<span class="number">5</span> &lt;&lt; <span class="number">2</span>);<span class="comment">// 运行结果是20</span></div></pre></td></tr></table></figure>
<p>左移运算符就是相当于第一个数乘以2的第二个数次方，就是5<code>*</code>2<code>*</code>2</p>
<p>char是当成int来计算的，所以在也可以表示成<code>0000 0000 0000 0000 0000 0000 0000 0000</code></p>
<p>每一位都代表2的几次方，所以可以使用<code>1 &lt;&lt; (charA[i] - &#39;A&#39;)</code>把数组中的某一个数据变成了上面32个0中间的一个1，也就是某一位，而且某一位只能代表一个字符</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">hashCheck</span><span class="params">(<span class="keyword">char</span>[] s1, <span class="keyword">char</span>[] s2)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> mask = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> c: s1) &#123;</div><div class="line">        mask = mask | (<span class="number">1</span> &lt;&lt; (c - <span class="string">'A'</span>));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> c: s2) &#123;</div><div class="line">        <span class="keyword">if</span> ((mask &amp; (<span class="number">1</span> &lt;&lt; (c - <span class="string">'A'</span>))) == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>先求位运算可以使得数据最大化，也就是那一个位上有1，再求与运算，可以得出在s2中是否有那一个位</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>整理自：<a href="https://github.com/julycoding/The-Art-Of-Programming-By-July/blob/master/ebook/code/java/chapter1/1.2：字符串包含.java" target="_blank" rel="external">https://github.com/julycoding/The-Art-Of-Programming-By-July/blob/master/ebook/code/java/chapter1/1.2：字符串包含.java</a></p>
<p><a href="https://github.com/julycoding/The-Art-Of-Programming-By-July/blob/master/ebook/zh/01.02.md" target="_blank" rel="external">https://github.com/julycoding/The-Art-Of-Programming-By-July/blob/master/ebook/zh/01.02.md</a></p>
<p><a href="http://aijuans.iteye.com/blog/1850655" target="_blank" rel="external">http://aijuans.iteye.com/blog/1850655</a></p>
<p><a href="http://www.cnblogs.com/0201zcr/p/4764427.html" target="_blank" rel="external">http://www.cnblogs.com/0201zcr/p/4764427.html</a><br>感觉收获到知识请您随便赞赏<img src="http://oaxelf1sk.bkt.clouddn.com/rmb.jpg" alt="天意"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/14/algorithm/Manacher算法及其Java实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="天意">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://oaxelf1sk.bkt.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="难得糊涂">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/14/algorithm/Manacher算法及其Java实现/" itemprop="url">
                  Manacher算法及其Java实现
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-14T14:51:35+08:00">
                2017-03-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index">
                    <span itemprop="name">Algorithm</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><p>现给定一个已知的字符串str[]，现在想要在O(n)的时间复杂度之内求出一个最长的回文子字符串(正着和倒着顺序读一致)。</p>
<p>Manacher最早发现了可以用O(n)的时间复杂度来解决该问题，所以这种方法称之为Manacher算法</p>
<h2 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h2><h3 id="基本过程"><a href="#基本过程" class="headerlink" title="基本过程"></a>基本过程</h3><p>求最大回文字串的长度一般要看原串的长度是奇数还是偶数，然后再分别求得，但是Manacher算法的第一个神奇之处，就是把两种字符串都转化为奇数的字符串，从而简化计算：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1.构造新的字符串</span></div><div class="line"><span class="comment">// 为了避免奇数回文和偶数回文的不同处理问题，在原字符串中插入'#'，将所有回文变成奇数回文</span></div><div class="line">StringBuilder newStr = <span class="keyword">new</span> StringBuilder();</div><div class="line">newStr.append(<span class="string">'#'</span>);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.length(); i ++) &#123;</div><div class="line">    newStr.append(str.charAt(i));</div><div class="line">    newStr.append(<span class="string">'#'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>例如原来是aaaba的字符串变化之后就是，而且无论原来的字符串是奇数还是偶数，变化之后都是奇数（方便运算）<br><img src="http://oaxelf1sk.bkt.clouddn.com/snipaste_20170314_141428.png" alt="snipaste_20170314_141428"></p>
<p>当构建完成新的字符串之后，<strong>从左边第一个字符开始遍历，并且记录每一个字符的最大回文半径</strong>，（包括自身），比如第一个<code>#</code>的回文半径就是1，左边第一个<code>A</code>的回文半径是2，遍历每一个字符之后，得到一个关于半径的数组，数组最大的值减1就是最大回文字串的长度，例如：</p>
<p><img src="http://oaxelf1sk.bkt.clouddn.com/snipaste_20170314_142301.png" alt="snipaste_20170314_142301"></p>
<h3 id="完整实现"><a href="#完整实现" class="headerlink" title="完整实现"></a>完整实现</h3><p>Manacher算法引入三个重要的概念（符号可能有所不同）：</p>
<p>第一个是表示已知回文字串的中心点位置id，第二个是已知回文字串最右边的位置right，最后一个就是表示已知字串的回文半径数组rad[]</p>
<p>对应上面来说，id就是不断遍历的位置信息，right就是回文半径<code>+</code>id<code>-</code>1，rad[]也就是把每一个半径存放起来</p>
<h4 id="确定最小半径"><a href="#确定最小半径" class="headerlink" title="确定最小半径"></a>确定最小半径</h4><p>假设现在求出了rad[1, …, i]，现在要求后面的rad值，再假设现在有个指针k（实际中就是1），从1循环到rad[i]，试图通过某些手段来求出[i + 1, i + rad[i] - 1]的rad值</p>
<p>如图所示，黑色的部分是一个回文子串，两段红色的区间对称相等。因为之前已经求出了rad[i - k]，所以可以避免一些重复的查找和判断，有3种情况：</p>
<p><img src="http://oaxelf1sk.bkt.clouddn.com/001az5G6gy6Gck3Wwgu5e&amp;690.jpg" alt="001az5G6gy6Gck3Wwgu5e&amp;690"></p>
<ul>
<li>rad[i] - k &lt; rad[i - k]</li>
</ul>
<p>如图，rad[i - k]的范围为青色。因为黑色的部分是回文的,且青色的部分超过了黑色的部分，所以rad[i + k]肯定至少为rad[i]-k,即橙色的部分。那橙色以外的部分就不是了吗?这是肯定的，因为如果橙色以外的部分也是回文的，那么根据青色和红色部分的关系，可以证明黑色部分再往外延伸一点也是一个回文子串,这肯定是不可能的，因此rad[i + k] = rad[i] - k</p>
<p><img src="http://oaxelf1sk.bkt.clouddn.com/001az5G6gy6Gck6wd628a&amp;69020171427.jpg" alt="001az5G6gy6Gck6wd628a&amp;69020171427"></p>
<ul>
<li>rad[i] - k &gt; rad[i - k]</li>
</ul>
<p>如图，rad[i-k]的范围为青色，因为黑色的部分是回文的，且青色的部分在黑色的部分里面，根据定义，很容易得出:rad[i + k] = rad[i - k]。</p>
<p>根据上面两种情况，可以得出结论:当rad[i] - k != rad[i - k]的时候,<strong>rad[i + k] = min(rad[i] - k, rad[i - k])</strong></p>
<p><img src="http://oaxelf1sk.bkt.clouddn.com/001az5G6gy6Gck8urVI76&amp;69020143141426.jpg" alt="001az5G6gy6Gck8urVI76&amp;69020143141426"></p>
<ul>
<li>rad[i] - k = rad[i - k]</li>
</ul>
<p>如图，通过和第一种情况对比之后会发现，因为青色的部分没有超出黑色的部分，所以即使橙色的部分全等，也无法像第一种情况一样引出矛盾，因此橙色的部分是有可能全等的。</p>
<p>根据已知的信息，我们不知道橙色的部分是多长，因此就需要再去尝试和判断了，但是最少<strong>rad[i + k] = min(rad[i] - k, rad[i - k])</strong>，当然此时两者相等</p>
<h4 id="具体代码"><a href="#具体代码" class="headerlink" title="具体代码"></a>具体代码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getPalindromeLength</span><span class="params">(String str)</span> </span>&#123;</div><div class="line">    <span class="comment">// 1.构造新的字符串</span></div><div class="line">    <span class="comment">// 为了避免奇数回文和偶数回文的不同处理问题，在原字符串中插入'#'，将所有回文变成奇数回文</span></div><div class="line">    StringBuilder newStr = <span class="keyword">new</span> StringBuilder();</div><div class="line">    newStr.append(<span class="string">'#'</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.length(); i ++) &#123;</div><div class="line">        newStr.append(str.charAt(i));</div><div class="line">        newStr.append(<span class="string">'#'</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// rad[i]表示以i为中心的回文的最大半径，i至少为1，即该字符本身</span></div><div class="line">    <span class="keyword">int</span> [] rad = <span class="keyword">new</span> <span class="keyword">int</span>[newStr.length()];</div><div class="line">    <span class="comment">// right表示已知的回文中，最右的边界的坐标</span></div><div class="line">    <span class="keyword">int</span> right = -<span class="number">1</span>;</div><div class="line">    <span class="comment">// id表示已知的回文中，拥有最右边界的回文的中点坐标</span></div><div class="line">    <span class="keyword">int</span> id = -<span class="number">1</span>;</div><div class="line">    <span class="comment">// 2.计算所有的rad</span></div><div class="line">    <span class="comment">// 这个算法是O(n)的，因为right只会随着里层while的迭代而增长，不会减少。</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; newStr.length(); i ++) &#123;</div><div class="line">        <span class="comment">// 2.1.确定一个最小的半径</span></div><div class="line">        <span class="keyword">int</span> r = <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> (i &lt;= right) &#123;</div><div class="line">            r = Math.min(rad[id] - i + id, rad[<span class="number">2</span> * id - i]);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 2.2.尝试更大的半径</span></div><div class="line">        <span class="keyword">while</span> (i - r &gt;= <span class="number">0</span> &amp;&amp; i + r &lt; newStr.length() &amp;&amp; newStr.charAt(i - r) == newStr.charAt(i + r)) &#123;</div><div class="line">            r++;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 2.3.更新边界和回文中心坐标</span></div><div class="line">        <span class="keyword">if</span> (i + r - <span class="number">1</span>&gt; right) &#123;</div><div class="line">            right = i + r - <span class="number">1</span>;</div><div class="line">            id = i;</div><div class="line">        &#125;</div><div class="line">        rad[i] = r;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// 3.扫描一遍rad数组，找出最大的半径</span></div><div class="line">    <span class="keyword">int</span> maxLength = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> r : rad) &#123;</div><div class="line">        <span class="keyword">if</span> (r &gt; maxLength) &#123;</div><div class="line">            maxLength = r;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> maxLength - <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="复杂度分析"><a href="#复杂度分析" class="headerlink" title="复杂度分析"></a>复杂度分析</h3><p>空间复杂度：插入分隔符形成新串，占用了线性的空间大小；RL数组也占用线性大小的空间，因此空间复杂度是线性的。<br>时间复杂度：尽管代码里面有两层循环，通过amortized analysis我们可以得出，Manacher的时间复杂度是线性的。由于内层的循环只对尚未匹配的部分进行，因此对于每一个字符而言，只会进行一次，因此时间复杂度是<strong>O(n)</strong></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="http://blog.sina.com.cn/s/blog_3fe961ae0101iwc2.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_3fe961ae0101iwc2.html</a></p>
<p><a href="https://segmentfault.com/a/1190000003914228#articleHeader7" target="_blank" rel="external">https://segmentfault.com/a/1190000003914228#articleHeader7</a></p>
<p><a href="http://blog.csdn.net/pi9nc/article/details/9251455" target="_blank" rel="external">http://blog.csdn.net/pi9nc/article/details/9251455</a></p>
<p><a href="http://blog.csdn.net/xingyeyongheng/article/details/9310555" target="_blank" rel="external">http://blog.csdn.net/xingyeyongheng/article/details/9310555</a><br>感觉收获到知识请您随便赞赏<img src="http://oaxelf1sk.bkt.clouddn.com/rmb.jpg" alt="天意"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://oaxelf1sk.bkt.clouddn.com/avatar.png"
               alt="天意" />
          <p class="site-author-name" itemprop="name">天意</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags.html">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              天意博文
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.haotianyi.win/" title="Title" target="_blank">Title</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">天意</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  








  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  
    
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "ccd54266e034423db44e7611bc2149f6",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
  










  





  

  

  

  

  

</body>
</html>
